<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.ccb.ProdPms.mapper.StateMapper">

    <resultMap id="state" type="com.ccb.ProdPms.entity.StateEntity">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="state_type" property="stateType" jdbcType="VARCHAR"/>
        <result column="state_name" property="stateName" jdbcType="VARCHAR"/>
        <result column="op_person" property="opPerson" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="DATE"/>
        <result column="change_time" property="changeTime" jdbcType="DATE"/>

    </resultMap>


    <!-- 查找全部 -->
    <select id="selectAllState" resultMap="state">
        select *
        from state
        where is_deleted=0
    </select>

    <!-- 条件查找 -->
    <select id="selectStateByParams" parameterType="com.ccb.ProdPms.entity.StateQueryEntity"
            resultMap="state">
        select id, state_type, state_name, op_person, create_time, change_time
        from state
        where isdeleted=0
        <if test="id!=null and id!=''">
            and id like '%${id}%'
        </if>
        <if test="stateType!=null and stateType!=''">
            and state_type like '%${stateType}%'
        </if>
        <if test="stateName!=null and stateName!=''">
            and state_name like '%${stateName}%'
        </if>
        <if test="opPerson!=null and opPerson!=''">
            and op_person like '%${opPerson}%'
        </if>
        <if test="beginTime!=null and endTime!=null">
            and create_time between #{beginTime} and #{endTime}
        </if>
    </select>

    <!-- 新增数据 -->
    <insert id="insertState" parameterType="com.ccb.ProdPms.entity.StateEntity">
        insert into state(state_type, state_name, create_time, change_time, op_person, is_deleted)
        values (#{stateType}, #{stateName}, now(), null, #{opPerson}, 0)
    </insert>

    <!-- 修改数据 -->
    <update id="updateState" parameterType="com.ccb.ProdPms.entity.StateEntity">
        update state set
        state_type=#{stateType,jdbcType=VARCHAR},
        state_name=#{stateName,jdbcType=VARCHAR},
        change_time=#{changeTime,jdbcType=VARCHAR},
        op_person=#{opPerson,jdbcType=VARCHAR}
        where
        is_deleted=0 and
        id=#{id,jdbcType=INTEGER}
    </update>

    <!-- 假删除 -->
    <update id="deletedState" parameterType="com.ccb.ProdPms.entity.StateEntity">
        update state
        set is_deleted = 1
        where id=#{id}
    </update>
</mapper>