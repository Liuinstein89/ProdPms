<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>登录</title>

    <link rel="stylesheet" type="text/css" href="../static/src/css/layui.css" />
    <link rel="stylesheet" type="text/css" href="../static/css/login.css" />
    <!--<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />-->
</head>
<body>
<div class="container">
    <div class="inset">
        <div class="login-head">
            <h1>ProdPMS登录</h1>
        </div>
        <form>
            <li>
                <input type="text" class="username"  id="login_uname" placeholder="用户名" />
                <a href="#" class=" icon user"></a>
            </li>

            <li>
                <input type="password" class="password" id="login_pwd" placeholder="密码"/>
                <a href="#" class="icon lock"></a>
            </li>

            <div class="submit layui-inline">
                <button type="button"  class="layui-btn layui-btn-lg" lay-submit="" lay-filter="btnSubmit">立即登录</button>
                <a href="login.html#" onclick="alert('忘记密码请联系系统管理员！')">忘记密码?</a>
            </div>
        </form>

    </div>
</div>

</body>
<script src="../static/src/layui.js" type="text/javascript" charset="utf-8"></script>
<script src="../static/src/public.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">

    layui.use(['form','jquery','layer'], function(){
        var form = layui.form;
        var $ = layui.jquery;
        var layer = layui.layer;

        form.on('submit(btnSubmit)', function(data){
            var luname = $('#login_uname').val();//用户名
            var lpwd = $('#login_pwd').val();//密码

            if (luname == '') {
                layer.msg("请输入用户名!");
                return false;
            }

            if (lpwd == '') {
                layer.msg("请输入密码!");
                return false;
            }
         
             $.ajax({
                 url : '/loginVerify',
               data :{
            	   username:$("#login_uname").val(),
                   password:$("#login_pwd").val(),
                },
                type : 'POST',//默认以get提交，以get提交如果是中文后台会出现乱码
              	dataType : 'text',
                success : function(obj) {
                    if (obj=="success") {
 setCookie("name","hayden");
                         window.location.href = "admin";//跳转 ，目前不确定
                   } else if(obj=="login error"){
                        layer.msg("用户名或密码错误!");
 setCookie("name",$("#login_uname").val());
                        window.location.href = "admin";//跳转 ，目前不确定
                     }
                }
             }); 
            return false;
        });
function setCookie(name,value) {
            document.cookie = name + '=' + escape(value);
        }

        function getCookie(name) {
            var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)"); //正则匹配
            if(arr=document.cookie.match(reg)){
                return unescape(arr[2]);
            }
            else{
                return null;
            }
        }
    });
</script>
</html>